import{a as Z}from"./chunk-RCXSQJPR.js";import{a as q}from"./chunk-HUU225A4.js";import{a as G}from"./chunk-UCBTXWIZ.js";import{a as Q,b as $,c as u,d as H,e as U,f as W}from"./chunk-CWYN3KJL.js";import{a as ee}from"./chunk-DP6XK2WQ.js";import"./chunk-FK6H3RFT.js";import"./chunk-MFRZFDYH.js";import{a as N}from"./chunk-WK5LHWFN.js";import"./chunk-YFIFGCVU.js";import{m as X,q as R}from"./chunk-URTYCW6E.js";import{$b as j,Bb as m,Cb as l,Gb as D,Hb as k,Ib as V,Kb as r,Lb as z,Mb as _,Qa as d,Tb as A,X as f,Xb as L,_ as M,_b as w,ab as p,ac as F,gb as E,ia as c,ja as s,ka as O,la as B,nb as T,ob as x,pb as v,qb as b,rb as a,sb as i,tb as C,wa as y,wb as I}from"./chunk-VVXUQ5S5.js";import{e as K}from"./chunk-CWTPBX7D.js";var Y=K(ee());var te=["table"],ne=(o,g,e)=>({itemsPerPage:o,currentPage:g,totalItems:e});function ie(o,g){if(o&1&&(a(0,"p",38),r(1),i()),o&2){let e=g.$implicit;d(),z(e)}}function ae(o,g){if(o&1&&(a(0,"tr")(1,"td"),r(2),i(),a(3,"td"),r(4),i(),a(5,"td"),r(6),i(),a(7,"td"),r(8),i(),a(9,"td"),r(10),w(11,"date"),i(),a(12,"td"),v(13,ie,2,1,"p",38,x),i(),a(15,"td"),r(16),i()()),o&2){let e=g.$implicit,t=g.$index;d(2),_(" ",t+1," "),d(2),_(" ",e.model," "),d(2),_(" ",e.carNumber," "),d(2),_(" ",e.color," "),d(2),_(" ",j(11,6,e.licenseDate)," "),d(3),b(e.driversName),d(3),_(" ",e.petrolType," ")}}function re(o,g){if(o&1){let e=I();a(0,"div",14)(1,"div",15)(2,"div",16)(3,"div",17)(4,"div",18)(5,"input",19),m("input",function(n){c(e);let h=l();return s(h.filteredData(n))}),i(),O(),a(6,"svg",20),C(7,"path",21)(8,"path",22),i()()(),B(),a(9,"div",23)(10,"div")(11,"i",24),m("click",function(){c(e);let n=l();return s(n.downloadExcel())}),i()(),a(12,"div")(13,"i",25),m("click",function(){c(e);let n=l();return s(n.downloadPDF())}),i()()()(),a(14,"div",26)(15,"table",27,0)(17,"thead",28)(18,"tr")(19,"th",29),m("click",function(){c(e);let n=l();return s(n.sortTable("index"))}),r(20,"#"),i(),a(21,"th",29),m("click",function(){c(e);let n=l();return s(n.sortTable("model"))}),r(22,"Model"),i(),a(23,"th",29),m("click",function(){c(e);let n=l();return s(n.sortTable("carNumber"))}),r(24,"Plate"),i(),a(25,"th",29),m("click",function(){c(e);let n=l();return s(n.sortTable("color"))}),r(26,"Color"),i(),a(27,"th",29),m("click",function(){c(e);let n=l();return s(n.sortTable("licenseDate"))}),r(28,"License Date"),i(),a(29,"th",29),m("click",function(){c(e);let n=l();return s(n.sortTable("driverName"))}),r(30,"Driver Name"),i(),a(31,"th",29),m("click",function(){c(e);let n=l();return s(n.sortTable("petrolType"))}),r(32,"Petrol Type"),i()()(),a(33,"tbody"),v(34,ae,17,8,"tr",null,x),w(36,"paginate"),i()(),a(37,"div",30)(38,"div")(39,"select",31),m("change",function(n){c(e);let h=l();return s(h.onChangePageSize(n))}),a(40,"option",32),r(41,"10"),i(),a(42,"option",33),r(43,"25"),i(),a(44,"option",34),r(45,"50"),i(),a(46,"option",35),r(47,"100"),i(),a(48,"option",36),r(49,"All"),i()()(),a(50,"div")(51,"pagination-controls",37),m("pageChange",function(n){c(e);let h=l();return s(h.onPageChange(n))}),i()()()()()()}if(o&2){let e=l();d(34),b(F(36,0,e.allCars(),L(3,ne,e.pageSize(),e.currentPage(),e.totalCars())))}}function oe(o,g){o&1&&(a(0,"div",39),C(1,"img",40),i())}var be=(()=>{class o{constructor(){this._CarService=f(Z),this._DriverService=f(q),this._BranchService=f(G),this._ActivatedRoute=f(N),this._PLATFORM_ID=f(y),this.branchId=p(""),this.companyId=p(localStorage.getItem("companyId")||""),this.allCars=p([]),this.driverBranch=p([]),this.allPage=p(0),this.currentPage=p(0),this.pageSize=p(0),this.totalCars=p(0),this.totalDrivers=p(0),this.sortColumn=p(""),this.sortDirection=p(!0)}ngOnInit(){this.getBranchById()}getBranchById(){this._ActivatedRoute.paramMap.subscribe(e=>{this.branchId.set(e.get("id")),this.getAllCars(),this.getAllDrivers()})}getAllCars(){this._CarService.GetAllCarsByBranchId(this.branchId()).subscribe(e=>{this.allCars.set(e.data.items),this.totalCars.set(e.data.totalCount),this.allPage.set(Math.ceil(e.data.totalCount/e.data.pageSize)),this.currentPage.set(e.data.pageNumber),this.pageSize.set(e.data.pageSize)})}getAllDrivers(){this._DriverService.GetDriversInBranch(this.branchId()).subscribe(e=>{this.driverBranch.set(e.data.items),this.totalDrivers.set(e.data.totalCount)})}filteredData(e){let t=e.target.value;this._CarService.GetAllCarsByBranchId(this.branchId(),t).subscribe(n=>{this.allCars.set(n.data.items)})}sortTable(e){this.sortColumn()===e?this.sortDirection.set(!this.sortDirection()):(this.sortColumn.set(e),this.sortDirection.set(!0)),this.allCars.update(t=>[...t].sort((n,h)=>n[e]>h[e]?this.sortDirection()?1:-1:n[e]<h[e]?this.sortDirection()?-1:1:0))}onPageChange(e){this.currentPage.set(e),this.changePagePagination(e)}changePagePagination(e){this._CarService.GetAllCarsByBranchId(this.branchId(),"",e).subscribe(t=>{this.allCars.set(t.data.items)})}onChangePageSize(e){let t=e.target.value;this._CarService.GetAllCarsByBranchId(this.branchId(),"",1,t).subscribe(n=>{this.pageSize.set(Number(t)),this.allCars.set(n.data.items)})}downloadPDF(){if(R(this._PLATFORM_ID)){let e=this.template.nativeElement;(0,Y.default)(e).then(t=>{let P=t.height*208/t.width,le=P,S=new Q("p","mm","a4"),J=t.toDataURL("image/png");S.addImage(J,"png",0,0,208,P),S.save("table.pdf")})}}downloadExcel(){let e=u.table_to_sheet(this.template.nativeElement),t=u.book_new();u.book_append_sheet(t,e,"Sheet1"),$(t,"table_data.xlsx")}static{this.\u0275fac=function(t){return new(t||o)}}static{this.\u0275cmp=M({type:o,selectors:[["app-branchdetails"]],viewQuery:function(t,n){if(t&1&&D(te,5),t&2){let h;k(h=V())&&(n.template=h.first)}},standalone:!0,features:[A],decls:26,vars:3,consts:[["table",""],[1,"row","g-3"],[1,"col-12","animate__animated","animate__fadeInDown"],[1,"row","g-2"],[1,"col-md-6"],[1,"head-card","position-relative","bg-white","h-100","d-flex","justify-content-between","aling-items-center","rounded-3","py-2","ps-4","pe-5"],[1,"d-flex","flex-column","justify-content-center","align-items-center"],[1,"m-0"],[1,"icon-head","p-1","drivers","d-flex","justify-content-center","align-items-center","rounded-2","mt-3"],[1,"fa-solid","fa-user-tie"],["loading","lazy","src","https://mannatthemes.com/approx/default//s/extra/corner.png","alt","",1,"position-absolute","bottom-0","end-0"],[1,"head-card","position-relative","bg-white","h-100","d-flex","justify-content-between","aling-items-center","rounded-3","py-3","ps-4","pe-5"],[1,"icon-head","p-1","cars","d-flex","justify-content-center","align-items-center","rounded-2","mt-3"],[1,"fa-solid","fa-car"],[1,"col-12","animate__animated","animate__fadeInUp","z-2"],[1,"bg-white","rounded-3","p-4"],[1,"d-flex","justify-content-between","align-items-center","gap-3","mb-3","flex-wrap"],[1,"d-flex","gap-3"],[1,"search","position-relative"],["type","search","placeholder","Search... ",1,"form-control","bg-white","rounded-2",3,"input"],["width","30","height","31","viewBox","0 0 30 31","xmlns","http://www.w3.org/2000/svg"],["d","M12.5081 25.5129C15.3929 25.5167 18.1895 24.5185 20.4201 22.689L27.8808 30.1489C28.3776 30.6288 29.1692 30.615 29.649 30.1182C30.117 29.6335 30.117 28.8652 29.649 28.3805L22.1896 20.9194C26.5593 15.5706 25.766 7.69188 20.4177 3.32182C15.0693 -1.04824 7.19128 -0.254835 2.82159 5.09394C-1.54811 10.4427 -0.754773 18.3214 4.59356 22.6915C6.82738 24.5167 9.62347 25.5135 12.5081 25.5129Z"],["d","M22.5 12.9998C22.5 18.5231 18.0228 23.0006 12.5 23.0006C6.97715 23.0006 2.5 18.5231 2.5 12.9998C2.5 7.4765 6.97715 2.99897 12.5 2.99897C18.0228 2.99897 22.5 7.4765 22.5 12.9998Z","fill","white"],[1,"d-flex","justify-content-center","align-items-center","gap-3"],[1,"text-success","fa-solid","fa-file-excel","fs-3","cr",3,"click"],[1,"text-danger","fa-solid","fa-file-pdf","fs-3","cr",3,"click"],[1,"table-responsive"],[1,"table","table-striped","text-center"],[1,"table-head"],[1,"fw-medium","cr",3,"click"],[1,"d-flex","justify-content-between","align-items-center"],["name","pageSize","id","pageSize",1,"form-select","bg-white","py-1",3,"change"],["value","10"],["value","25"],["value","50"],["value","100"],["value","10000"],[1,"d-flex","justify-content-start","my-pagination",3,"pageChange"],[1,"text-table"],[1,"vh-100","d-flex","flex-column","justify-content-center","align-items-center","bg-white","shadow","rounded-3"],["loading","lazy","src","/assets/image/error_9042574.png","alt","error404","srcset","",1,"err-img"]],template:function(t,n){t&1&&(a(0,"section")(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"p",7),r(8,"Total Drivers"),i(),a(9,"h3"),r(10),i()(),a(11,"div",8),C(12,"i",9),i(),C(13,"img",10),i()(),a(14,"div",4)(15,"div",11)(16,"div",6)(17,"p",7),r(18,"Total Vehicles"),i(),a(19,"h3"),r(20),i()(),a(21,"div",12),C(22,"i",13),i(),C(23,"img",10),i()()()(),E(24,re,52,7,"div",14)(25,oe,2,0),i()()),t&2&&(d(10),_(" ",n.totalDrivers()," "),d(10),_(" ",n.totalCars()," "),d(4),T(24,n.allCars.length?24:25))},dependencies:[W,H,U,X],styles:[".head-card[_ngcontent-%COMP%]   .icon-head[_ngcontent-%COMP%]{height:fit-content;border:1px dotted}.head-card[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:130px;height:100%;object-fit:cover;filter:sepia(350%)}.head-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#96a0b5;font-size:18px}.head-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-weight:500;color:#222}i[_ngcontent-%COMP%]{font-size:25px!important}.cars[_ngcontent-%COMP%], .drivers[_ngcontent-%COMP%]{border-color:#ffbf00!important}.cars[_ngcontent-%COMP%]   i[_ngcontent-%COMP%], .drivers[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#ffbf00}.my-pagination[_ngcontent-%COMP%]     .ngx-pagination .current{background:#f79320!important;color:#fff!important}.err-img[_ngcontent-%COMP%]{width:300px}.table-head[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#b5b5b570!important}.add-btn[_ngcontent-%COMP%]{border:1px solid rgba(249,123,33,.5647058824);width:fit-content;padding:0 10px;transition:all .3s}.add-btn[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{color:#f79320;transition:all .3s}.add-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:#f97c21;transition:all .3s}.add-btn[_ngcontent-%COMP%]:hover{background-color:#f79320}.add-btn[_ngcontent-%COMP%]:hover   h5[_ngcontent-%COMP%]{color:#fff}.add-btn[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:#fff}.dis-active-btn[_ngcontent-%COMP%]{width:fit-content;border:none;font-size:12px;background-color:#dcdcdc}.active-btn[_ngcontent-%COMP%]{width:fit-content;border:none;font-size:12px;background-color:#008d7a}.search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:300px;border:1px solid rgba(249,123,33,.5647058824)}.search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::placeholder{color:#b8b8b8;font-weight:300}.search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:#f79320!important}.search[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{position:absolute;top:50%;transform:translateY(-50%);right:10px;width:20px;fill:#f79320}@media (max-width: 567px){.search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:200px;border:1px solid rgba(249,123,33,.5647058824);background-color:#fff}}"]})}}return o})();export{be as BranchdetailsComponent};
